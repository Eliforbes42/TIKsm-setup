tests:

  # container_status.tick triggers no warning alert when the measurement 
  # container_status in the dbrp telegraf:autogen is running
  - name: "Alert Container Status:: No warning when running"  
    task_name: container_status.tick
    db: telegraf
    rp: default
    type: stream
    data:
      - docker_container_status,"container_status"='running' container_name=somename
      - docker_container_status,"container_status"='running' container_name=somenametwo
    expects:
      ok: 0
      warn: 0
      crit: 0

  # container_status.tick triggers a warning alert when the measurement 
  # container_status in the dbrp telegraf:autogen is not running
  - name: "Alert Container Status:: Warning when not running"  
    task_name: container_status.tick
    db: telegraf
    rp: default
    type: stream
    data:
      - docker_container_status,container_status=error container_name=somename time=1542658620000000000
      - docker_container_status,container_status=error container_name=somenametwo time=1542658630000000000
    expects:
      ok: 0
      warn: 1
      crit: 0

      
#pod tests      
  - name: "Slack Alert:: on failed Pod test"
    task_name: failed_pod_alert.tick
    db: telegraf
    rp: default
    type: stream
    data: 
    - kube_pod_status_phase,time=1542658620000000000 gauge=0 host=telegraf-polling-service namespace=default phase='Failed' pod=db-79b64dd4bb-tgjqt url=http://metrics-kube-state-metrics.kube-system.svc.cluster.local:8085/metrics
    - kube_pod_status_phase,time=1542658630000000000 gauge=1 host=telegraf-polling-service namespace=default phase='Failed' pod=db-79b64dd4bb-tgjqt
    - kube_pod_status_phase,time=1542658620000000000 gauge=0 host=telegraf-polling namespace=default phase='Failed' pod=db-79b64dd4bb-tgjqt url=http://metrics-kube-state-metrics.kube-system.svc.cluster.local:8085/metrics
    - kube_pod_status_phase,time=1542658630000000000 gauge=1 host=telegraf-polling namespace=default phase='Failed' pod=db-79b64dd4bb-tgjqt
    - kube_pod_status_phase,time=1542658620000000000 gauge=0 host=telegraf namespace=default phase='Failed' pod=db-79b64dd4bb-tgjqt url=http://metrics-kube-state-metrics.kube-system.svc.cluster.local:8085/metrics
    - kube_pod_status_phase,time=1542658630000000000 gauge=1 host=telegraf namespace=default phase='Failed' pod=db-79b64dd4bb-tgjqt
    expects:
      ok: 0
      warn: 1
      crit: 0

#slack test
  - name: "Alert Slack:: Usage critical when idle < 100%, lol"
    task_name: slack_alert.tick
    db: telegraf
    rp: default
    type: stream
    data:
    - cpu,usage_guest=0 usage_guest_nice=0 usage_idle=10 usage_iowait=10 usage_irq=10 usage_nice=10 usage_softirq=10 usage_steal=10 usage_system=10 usage_user=10
    expects:
      ok: 0
      warn: 1
      crit: 0
      
      
      
      
      
      
      
#example test cases
  # alert_weather.tick triggers a critical alert when the measurement 
  # temperature in the dbrp weather:default is bigger than 80
  - name: "Alert weather:: critical when temperature > 120"  
    task_name: alert_weather.tick
    db: weather
    rp: default
    type: stream
    data:
      - temperature,location=us-midwest temperature=70
      - temperature,location=us-midwest temperature=120
    expects:
      ok: 0
      warn: 0
      crit: 1

  # alert_weather.tick triggers a warning alert when the measurement temperature 
  # in the dbrp weather:default is bigger than 80
  - name: "Alert weather:: warning when 80 < temperature < 120"  
    task_name: alert_weather.tick
    db: weather
    rp: default
    type: stream
    data:
      - temperature,location=us-midwest temperature=70
      - temperature,location=us-midwest temperature=82
    expects:
      ok: 0
      warn: 1
      crit: 0

  # alert_weather.tick failed test
  - name: "Alert weather:: failure"  
    task_name: alert_weather.tick
    db: weather
    rp: default
    type: stream
    data:
      - temperature,location=us-midwest temperature=70
      - temperature,location=us-midwest temperature=82
    expects:
      ok: 2
      warn: 1
      crit: 1      
          